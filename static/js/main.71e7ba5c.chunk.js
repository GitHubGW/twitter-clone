(this["webpackJsonptwitter-clone"]=this["webpackJsonptwitter-clone"]||[]).push([[0],{45:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(25),i=n.n(c),s=n(7),o=n(19);n(33),n(46),n(47);o.a.initializeApp({apiKey:"AIzaSyB45R1Hdw7jQicAE4z9Wf0RVCQzmuG-BCQ",authDomain:"twitter-githubgw.firebaseapp.com",projectId:"twitter-githubgw",storageBucket:"twitter-githubgw.appspot.com",messagingSenderId:"193675462794",appId:"1:193675462794:web:ebb53a35ba1a6a99254573",measurementId:"G-LYWB6P7CEB"});var u=o.a,l=o.a.auth(),j=o.a.firestore(),d=o.a.storage(),b=n(18),p=n(6),f=n(28),O=n(5),h=n.n(O),x=n(12),m=n(1),g=function(e){var t=e.tweetObject,n=e.isOwner,r=Object(a.useState)(!1),c=Object(s.a)(r,2),i=c[0],o=c[1],u=Object(a.useState)(t.content),l=Object(s.a)(u,2),b=l[0],p=l[1],f="tweets",O=function(){var e=Object(x.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,j.collection(f).doc("".concat(t.documentId)).update({content:b});case 3:o(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("\ud2b8\uc717\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){e.next=7;break}return e.next=4,j.collection(f).doc("".concat(t.documentId)).delete();case 4:if(!t.fileDownloadUrl){e.next=7;break}return e.next=7,d.refFromURL(t.fileDownloadUrl).delete();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{children:i?Object(m.jsx)(m.Fragment,{children:n&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("form",{onSubmit:O,children:[Object(m.jsx)("input",{type:"text",placeholder:"\ud2b8\uc717 \uc218\uc815",value:b,onChange:function(e){var t=e.target.value;p(t)}}),Object(m.jsx)("input",{type:"submit",value:"\uc5c5\ub370\uc774\ud2b8"})]}),Object(m.jsx)("button",{onClick:function(){p(b),o(!1)},children:"\ucde8\uc18c"})]})}):Object(m.jsxs)(m.Fragment,{children:[t.fileDownloadUrl&&Object(m.jsx)("img",{style:{width:"250px",height:"200px"},src:t.fileDownloadUrl,alt:t.content}),Object(m.jsx)("h3",{children:t.content}),Object(m.jsx)("h4",{children:t.createdAtDate}),n&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{onClick:function(){o(!0),p(t.content)},children:"\ud2b8\uc717 \uc218\uc815"}),Object(m.jsx)("button",{onClick:g,children:"\ud2b8\uc717 \uc0ad\uc81c"})]})]})})},v=function(e){var t=e.userObject,n=Object(a.useState)(""),r=Object(s.a)(n,2),c=r[0],i=r[1],o=Object(a.useState)(""),u=Object(s.a)(o,2),b=u[0],p=u[1],f=Object(a.useState)(""),O=Object(s.a)(f,2),g=O[0],v=O[1],w=Object(a.useRef)(),y=Object(a.useRef)(),k=function(){var e=Object(x.a)(h.a.mark((function e(n){var a,r,s,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a="",r=l.currentUser,""===b){e.next=11;break}return s=d.ref().child("".concat(t.email,"/").concat(g)),e.next=7,s.putString(b,"data_url");case 7:return o=e.sent,e.next=10,o.ref.getDownloadURL();case 10:a=e.sent;case 11:return e.next=13,j.collection("tweets").add({uid:r.uid,displayName:r.displayName,email:r.email,emailVerified:r.emailVerified,photoURL:r.photoURL,creationTime:r.metadata.a,lastSignInTime:r.metadata.b,content:c,createdAtTime:Date.now(),createdAtDate:(new Date).toLocaleDateString(),fileDownloadUrl:a});case 13:w.current.value="",i(""),p("");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("form",{onSubmit:k,children:[Object(m.jsx)("input",{type:"text",placeholder:"\ud2b8\uc717 \uc785\ub825",value:c,onChange:function(e){var t=e.target.value;i(t)},maxLength:100,ref:y,required:!0}),Object(m.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0],n=null===t||void 0===t?void 0:t.name,a=new FileReader;a&&void 0!==t&&null!==t&&(console.log("zz",t),a.readAsDataURL(t),a.onload=function(e){var t=e.target.result;p(t)},v("".concat(n,"_").concat(Date.now())))},ref:w}),Object(m.jsx)("input",{type:"submit",value:"\ud2b8\uc717 \uc791\uc131"}),b&&Object(m.jsxs)("div",{children:[Object(m.jsx)("img",{src:b,alt:"",style:{width:"300px",height:"250px"}}),Object(m.jsx)("button",{onClick:function(){p(""),i(""),w.current.value=""},children:"\ucde8\uc18c"})]})]})})},w=function(e){var t=e.userObject;console.log("Home userObject",t);var n=Object(a.useState)(""),r=Object(s.a)(n,2),c=r[0],i=r[1],o=Object(a.useState)(0),u=Object(s.a)(o,2),l=u[0],d=u[1];return Object(a.useEffect)((function(){j.collection("tweets").orderBy("createdAtTime","desc").onSnapshot((function(e){var t=e.size;d(t);var n=e.docs.map((function(e){return Object(f.a)({documentId:e.id},e.data())}));i(n)}))}),[]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h1",{children:"Home"}),Object(m.jsx)(v,{userObject:t}),Object(m.jsxs)("h1",{children:["\uc804\uccb4 \ud2b8\uc717 \uac2f\uc218: ",l]}),Object(m.jsx)("div",{children:c&&c.map((function(e){return Object(m.jsx)(g,{tweetObject:e,isOwner:t.uid===e.uid},e.id)}))})]})},y=function(e){var t=e.userObject,n=e.refreshDisplayName;console.log("Profile userObject",t);var r=Object(p.g)(),c=Object(a.useState)(t.displayName),i=Object(s.a)(c,2),o=i[0],u=i[1],d=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.currentUser){e.next=5;break}return e.next=4,l.signOut();case 4:r.push("/");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.collection("tweets").where("uid","==",t.uid).orderBy("createdAtTime","desc").get();case 2:e.sent.docs.map((function(e){return console.log("getMyTweets doc",e.data())}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(x.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),t.displayName!==o){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.updateProfile({displayName:o});case 7:n(),u("");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){b()}),[]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h1",{children:"Profile"}),Object(m.jsxs)("form",{onSubmit:f,children:[Object(m.jsx)("input",{type:"text",placeholder:"\uc720\uc800 \ub2c9\ub124\uc784",onChange:function(e){var t=e.target.value;u(t)},value:o}),Object(m.jsx)("input",{type:"submit",value:"\ud504\ub85c\ud544 \uc5c5\ub370\uc774\ud2b8"})]}),Object(m.jsx)("button",{onClick:d,children:"\ub85c\uadf8\uc544\uc6c3"})]})},k=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),i=Object(s.a)(c,2),o=i[0],j=i[1],d=Object(a.useState)(!1),b=Object(s.a)(d,2),p=b[0],f=(b[1],Object(a.useState)(null)),O=Object(s.a)(f,2),g=O[0],v=O[1],w=function(){var e=Object(x.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("xxx",l.currentUser),e.prev=2,e.next=5,l.signInWithEmailAndPassword(n,o);case 5:a=e.sent,console.log("data1",a),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),v(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),y=function(e){var t=e.target,n=t.name,a=t.value;"emailInput"===n?r(a):"passwordInput"===n&&j(a)},k=function(){var e=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p){e.next=6;break}return e.next=4,l.createUserWithEmailAndPassword(n,o);case 4:t=e.sent,console.log("data2",t);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),v(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(x.a)(h.a.mark((function e(t){var n,a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("googleLogin"!==(n=t.target.name)){e.next=14;break}return e.prev=2,a=new u.auth.GoogleAuthProvider,e.next=6,l.signInWithPopup(a);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),v(e.t0.message);case 12:e.next=25;break;case 14:if("githubLogin"!==n){e.next=25;break}return e.prev=15,r=new u.auth.GithubAuthProvider,e.next=19,l.signInWithPopup(r);case 19:e.next=25;break;case 21:e.prev=21,e.t1=e.catch(15),console.log(e.t1),v(e.t1.message);case 25:case"end":return e.stop()}}),e,null,[[2,8],[15,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{children:[Object(m.jsxs)("form",{onSubmit:w,children:[Object(m.jsx)("input",{name:"emailInput",type:"text",placeholder:"\uc774\uba54\uc77c",onChange:y,value:n,required:!0}),Object(m.jsx)("input",{name:"passwordInput",type:"password",placeholder:"\ube44\ubc00\ubc88\ud638",onChange:y,value:o,required:!0}),Object(m.jsx)("input",{type:"submit",onClick:w,value:"\ub85c\uadf8\uc778"})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{onClick:k,children:"\ud68c\uc6d0\uac00\uc785"}),Object(m.jsx)("button",{name:"googleLogin",onClick:S,children:"\uad6c\uae00 \ub85c\uadf8\uc778"}),Object(m.jsx)("button",{name:"githubLogin",onClick:S,children:"\uae43\ud5c8\ube0c \ub85c\uadf8\uc778"}),Object(m.jsx)("span",{children:g&&g})]})]})},S=function(e){var t=e.userObject;return console.log("Navi userObject",t),Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("ul",{children:[Object(m.jsx)("li",{children:Object(m.jsx)(b.b,{to:"/",children:"\ud648"})}),Object(m.jsx)("li",{children:Object(m.jsxs)(b.b,{to:"/profile",children:[t&&t.displayName?t.displayName:"\uc720\uc800","\uc758 \ud504\ub85c\ud544"]})})]})})},D=function(e){var t=e.isLoggedIn,n=e.userObject,a=e.refreshDisplayName;return Object(m.jsxs)(b.a,{children:[t&&Object(m.jsx)(S,{userObject:n}),t?Object(m.jsxs)(p.d,{children:[Object(m.jsx)(p.b,{exact:!0,path:"/",children:Object(m.jsx)(w,{userObject:n})}),Object(m.jsx)(p.b,{exact:!0,path:"/profile",children:Object(m.jsx)(y,{userObject:n,refreshDisplayName:a})}),Object(m.jsx)(p.a,{from:"*",to:"/"})]}):Object(m.jsxs)(p.d,{children:[Object(m.jsx)(p.b,{exact:!0,path:"/",children:Object(m.jsx)(k,{})}),Object(m.jsx)(p.a,{from:"*",to:"/"})]})]})},I=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),i=Object(s.a)(c,2),o=i[0],u=i[1],j=Object(a.useState)(null),d=Object(s.a)(j,2),b=d[0],p=d[1];console.log("44",l.currentUser),console.log("55",b);return Object(a.useEffect)((function(){l.onAuthStateChanged((function(e){console.log("onAuthStateChanged User",e),e?(null===e.displayName&&e.updateProfile({displayName:"\uc720\uc800"}),u(!0),p({uid:e.uid,displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,photoURL:e.photoURL,creationTime:e.metadata.a,lastSignInTime:e.metadata.b,updateProfile:function(t){return e.updateProfile(t)}})):(u(!1),p(null)),r(!0)}))}),[]),Object(m.jsx)("div",{children:n?Object(m.jsx)(D,{isLoggedIn:o,userObject:b,refreshDisplayName:function(){console.log("4a",b);var e=l.currentUser;p({uid:e.uid,displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,photoURL:e.photoURL,creationTime:e.metadata.a,lastSignInTime:e.metadata.b,updateProfile:function(t){return e.updateProfile(t)}})}}):"Loading..."})};i.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(I,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.71e7ba5c.chunk.js.map